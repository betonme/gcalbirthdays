<html>
<head>
<title>gCalBirthdays</title>
<script type='text/javascript' src='http://www.google.com/jsapi'></script>

<script type="text/javascript">

/* Copyright (c) 2009 Frank Glaser
 * TODO
 */



  
//load the Google data JS Client Library
//google.load('gdata', '1.x');
google.load("gdata", "1.x", {packages: ["contacts", "calendar"]});

//This is the url for the user's default calendar
var EVENT_FEED_URL = 'http://www.google.com/calendar/feeds/default/private/full';


var APP_NAME  = 'gCalBirthdays';

var CALENDAR_NAME    = 'Birthdays';  //"Geburtstage";
var CALENDAR_SUMMARY = 'This calendar contains the birthdays of Your Google Contacts.';
var CALENDAR_COLOR   = '#A32929';    // red "#A32929", blue "#2952A3" and green "#0D7813"

var CONTACTS_FEED_URL  = 'http://www.google.com/m8/feeds/contacts/default/full';
var CALENDARS_FEED_URL = 'http://www.google.com/calendar/feeds/default/owncalendars/full';

var DATE_FORMAT_CONTACTS = 'yyyy-MM-dd';
var DATE_FORMAT_CALENDAR = 'yyyyMMdd';
var DATE_FORMAT_YEAR 	 = 'yyyy';

var REMINDER_DAYS = 14;

//This variables are used for retrieving and adding contacts/events
var contactService;
var calendarService;

/**
* This function checks if the user is logged in, 
* and changes the login button and displayed sections accordingly.
* It also initializes the calendarService variable
* and calls a function to fill in the form based on the URL.
*/
function init() {

 var token = google.accounts.user.checkLogin(EVENT_FEED_URL);

 contacservice = new google.gdata.contact.ContactService(APP_NAME);
 //calendarService = new google.gdata.calendar.CalendarService(APP_NAME);
 
 var authButton = document.getElementById('auth_button');

 if (google.accounts.user.checkLogin(EVENT_FEED_URL)) {
   authButton.value = 'Logout';
 } else {
   authButton.value = 'Login';
 }
};

//Tells the google JS lib to call the init function once loaded
google.setOnLoadCallback(init);

/**
* This function is triggered by the login/logout button.
* If the user is logged in to the app, it logs them out.
* If the user is logged out to the app, it logs them in.
*/
function loginOrLogout(){
 var token = google.accounts.user.checkLogin(EVENT_FEED_URL);
 if (token) {
   google.accounts.user.logout();
   init();
 } else {
   google.accounts.user.login(EVENT_FEED_URL);
 }
}

//]]>
</script>-->

</head>

<body>

<div class="indent">
Welcome to gCalBirthdays, an app that transfer Your Google Contacts birthdays to Your Google Calendar.
</div>

<div id="loginNotice" class="indent" style="color:#cc0000; font-weight:bold; display:none">
  Because this is a third-party app that uses your Google account authentication, you'll need to grant access to it by clicking the "Login" button. 
</div>

<div class="indent">
<input id="auth_button" type="button" value="Authenticate" onclick="loginOrLogout()"/>
</div>

<div id="addBirthday" class="indent" style="display:none">
	<div id="addEventHeader" style="font-weight: bold; border-bottom:1px solid grey;">Add Birthday:</div>
    <table>
      <tr>
        <td>Name:</td>
        <td><input id="name" type="text" style="width:100%"></td>
      </tr>
      <tr>
        <td>Birthdate:</td>
        <td><input id="birthdate" type="text" value="2007-08-16" style="width:100%"/></td>
      </tr>
    </table>
</div>

</body>

</html>
