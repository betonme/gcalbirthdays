<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs
    title="gCalBirthdays"
    title_url="http://gcalbirthdays.googlecode.com"
    author="Frank Glaser"
    author_email="GlaserFrank@gmail.com"
    scrolling="true">
    <Require feature="google.calendar-0.5"/>
    <Require feature="dynamic-height"/>
    <Require feature="setprefs"/>
    <UserPref name="test" display_name="Color" default_value="Yellow" datatype="hidden"/>
  </ModulePrefs>
  <Content type="html">
  	<![CDATA[
	  <!--http://phpjs.org/packages/view/396/name:7d67fb58ff9ab58f4d0e4e55221b50e7-->
      <script type="text/javascript" src="http://gcalbirthdays.googlecode.com/svn/trunk/gCalBirthdays/JS/html_funcs.min.js"></script>

	  <!--http://code.google.com/p/gdata-javascript-client/-->
      <script type="text/javascript" src="http://www.google.com/jsapi"></script>

	  <!--gCalBirthay Javascript functions for HTML and Gadget Version -->
	  <!--
      <script type="text/javascript" src="http://gcalbirthdays.googlecode.com/svn/trunk/gCalBirthdays/JS/gCalBirthdays.js"></script>
      <script type="text/javascript" src="gCalBirthdays.js"></script>
	  -->

      <!--gCalBirthay Gadget specific Javascript functions-->
      <script type="text/javascript">

	    //IE JScript 5.6 Compatibility
	    // Constants
	    var APP_NAME = 'gCalBirthdays';
	    var APP_VERSION = '2.007';

        var GOOGLE_FEED_AUTH = 'http://www.google.com/m8/feeds/ http://www.google.com/calendar/feeds/';

		// The gadget containers request that we do NOT run any JS inline.
		// Instead, register a callback handler.
		gadgets.util.registerOnLoadHandler(onLoadHandler);

        function onLoadHandler(){
          // Load the Google data JS Client Library
          //google.load('gdata', '1.x');
          // Save overhead, only load the necessary service
          google.load("gdata", "1.x", {packages: ['contacts', 'calendar']});

	      // Tells the google JS lib to call the init function once loaded
	      google.setOnLoadCallback(init);
	    };

	    function init(){
	      var authButton = document.getElementById('authButtonID');

	      document.getElementById('versionID').innerHTML = APP_NAME + ' Version: ' + APP_VERSION;

	      var token = google.accounts.user.checkLogin(GOOGLE_FEED_AUTH);
	      if (token) {
	        // User is loged in
	        authButton.value = 'Logout';
	        document.getElementById('loginNoticeID').style.display = 'none';
	        //document.getElementById('htmlConsoleID').style.display = 'block';
			//document.getElementById('consoleCheckboxFormID').style.display = 'block';
	        //mainJS();
	      }
	      else {
	        // User is loged out
	        authButton.value = 'Login';
	        document.getElementById('loginNoticeID').style.display = 'block';
	        //document.getElementById('settingsFormID').style.display = 'none';
	        //document.getElementById('htmlConsoleID').style.display = 'none';
			//document.getElementById('consoleCheckboxFormID').style.display = 'none';
	      }
	    };

	    function onClickAuthButton(){
	      var token = google.accounts.user.checkLogin(GOOGLE_FEED_AUTH);
	      if (token) {
	        // User is loged in
	        google.accounts.user.logout();
	      }
	      else {
	        // User is loged out
	        token = google.accounts.user.login(GOOGLE_FEED_AUTH);
	      }
	      init();
	    };

      </script>

      <img src="http://gcalbirthdays.googlecode.com/svn/trunk/gCalBirthdays/Gadget/gCalBirthdays.gif" alt="gCalBirthdays Logo"/>

      <p id="versionID">
          Version
      </p>

      <p>
          Welcome to gCalBirthdays, an app that transfer Your
          Google Contacts birthdays to Your Google Calendar.
      </p>

      <p id="loginNoticeID" style="color:#cc0000; font-weight:bold; display:none">
          Because this is a third-party app that uses your Google
          account authentication, you'll need to grant access to
          it by clicking the "Login" button.
      </p>

      <p>
        <input id="authButtonID" type="button" value="Authenticate" onclick="onClickAuthButton()">
      </p>
      <br>
	]]>
  </Content>
</Module>
